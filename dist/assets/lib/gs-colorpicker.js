import{COLOR_NAMES,PALETTE_MATERIAL_500,PALETTE_MATERIAL_CHROME,rgbToHex,hslToRgb,rgbToHsl,rgbToHsv,rgbToInt,intToRgb,cssColorToRgb,cssColorToRgba,parseColorToRgb,parseColorToRgba,parseColorToHsl,parseColorToHsla,parseColor,getLuminance,limit,ensureArray,nvl}from"./utils.js";const isPlainObject=t=>t?.constructor===Object;let HTML_BOX='\n<div class="gs-colorpicker-row gs-colorpicker-stack gs-colorpicker-row-top">\n    <canvas class="gs-colorpicker-sl gs-colorpicker-transparent"></canvas>\n    <div class="gs-colorpicker-dot"></div>\n</div>\n<div class="gs-colorpicker-row">\n   \n    <div class="gs-colorpicker-stack gs-colorpicker-transparent gs-colorpicker-circle">\n        <div class="gs-colorpicker-preview">\n            <input class="gs-colorpicker-clipbaord" type="text">\n        </div>\n    </div>\n    \n    <div class="gs-colorpicker-column color-sliders">\n        <div class="gs-colorpicker-cell gs-colorpicker-stack">\n            <canvas class="gs-colorpicker-h"></canvas>\n            <div class="gs-colorpicker-dot"></div>\n        </div>\n        <div class="gs-colorpicker-cell gs-colorpicker-alpha gs-colorpicker-stack" show-on-alpha>\n            <canvas class="gs-colorpicker-a gs-colorpicker-transparent"></canvas>\n            <div class="gs-colorpicker-dot"></div>\n        </div>\n    </div>\n    \n    <div class="gs-colorpicker-stack gs-colorpicker-eyedropper">\n            <svg stroke-width="1" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" color="#000000"><path d="M7 13.161L12.4644 7.6966C12.8549 7.30607 13.4881 7.30607 13.8786 7.6966L15.9999 9.81792C16.3904 10.2084 16.3904 10.8416 15.9999 11.2321L14.0711 13.161M7 13.161L4.82764 15.3334C4.73428 15.4267 4.66034 15.5376 4.61007 15.6597L3.58204 18.1563C3.07438 19.3892 4.30728 20.6221 5.54018 20.1145L8.03681 19.0865C8.1589 19.0362 8.26981 18.9622 8.36317 18.8689L14.0711 13.161M7 13.161H14.0711" stroke="#000000" stroke-width="1" stroke-linecap="round" stroke-linejoin="round"></path><path d="M13.878 3.45401L15.9993 5.57533M20.242 9.81798L18.1206 7.69666M15.9993 5.57533L17.4135 4.16112C17.8041 3.7706 18.4372 3.7706 18.8277 4.16112L19.5349 4.86823C19.9254 5.25875 19.9254 5.89192 19.5349 6.28244L18.1206 7.69666M15.9993 5.57533L18.1206 7.69666" stroke="#000000" stroke-width="1" stroke-linecap="round" stroke-linejoin="round"></path></svg>\n    </div>\n    \n</div>\n<div class="gs-colorpicker-row gs-colorpicker-hsl" show-on-hsl>\n    <label>H</label>\n    <input nameref="H" type="number" maxlength="3" min="0" max="360" value="0">\n    <label>S</label>\n    <input nameref="S" type="number" maxlength="3" min="0" max="100" value="0">\n    <label>L</label>\n    <input nameref="L" type="number" maxlength="3" min="0" max="100" value="0">\n</div>\n<div class="gs-colorpicker-row gs-colorpicker-rgb" show-on-rgb>\n    <label>R</label>\n    <input nameref="R" type="number" maxlength="3" min="0" max="255" value="0">\n    <label>G</label>\n    <input nameref="G" type="number" maxlength="3" min="0" max="255" value="0">\n    <label>B</label>\n    <input nameref="B" type="number" maxlength="3" min="0" max="255" value="0">\n</div>\n<div class="gs-colorpicker-row gs-colorpicker-rgbhex gs-colorpicker-single-input" show-on-single-input>\n    <label>HEX</label>\n    <input nameref="RGBHEX" type="text" pleceholder="HEX" select-on-focus>\n</div>\n<div class="gs-colorpicker-row gs-colorpicker-palette"></div>\n';const VERSION="1.2.2",IS_EDGE="undefined"!=typeof window&&window.navigator.userAgent.indexOf("Edge")>-1,IS_IE11="undefined"!=typeof window&&window.navigator.userAgent.indexOf("rv:")>-1,DEFAULT={id:null,attachTo:"body",showHSL:!0,showRGB:!0,showHEX:!0,showAlpha:!1,color:"#ff0000",palette:null,paletteEditable:!1,useAlphaInPalette:"auto",slBarSize:[232,150],hueBarSize:[130,11],alphaBarSize:[130,11]},HUE="H",SATURATION="S",LUMINANCE="L",RGB="RGB",RED="R",GREEN="G",BLUE="B",RGBHEX="RGBHEX",COLOR="COLOR",RGBA_USER="RGBA_USER",HSLA_USER="HSLA_USER",ALPHA="ALPHA";function parseElement(t,e,s){return t?t instanceof HTMLElement?t:t instanceof NodeList?t[0]:"string"==typeof t?document.querySelector(t):t.jquery?t.get(0):s?e:null:e}function parseElements(t){return t?Array.isArray(t)?t:t instanceof HTMLElement?[t]:t instanceof NodeList?[...t]:"string"==typeof t?[...document.querySelectorAll(t)]:t.jquery?t.get():[]:[]}function canvasHelper(t){const e=t.getContext("2d"),s=+t.width,i=+t.height,o=e.createLinearGradient(1,1,1,i-1);return o.addColorStop(0,"white"),o.addColorStop(1,"black"),{setHue(t){const n=e.createLinearGradient(1,0,s-1,0);n.addColorStop(0,`hsla(${t}, 100%, 50%, 0)`),n.addColorStop(1,`hsla(${t}, 100%, 50%, 1)`),e.fillStyle=o,e.fillRect(0,0,s,i),e.fillStyle=n,e.globalCompositeOperation="multiply",e.fillRect(0,0,s,i),e.globalCompositeOperation="source-over"},grabColor:(t,s)=>e.getImageData(t,s,1,1).data,findColor(t,e,o){const[,n,r]=rgbToHsv(t,e,o);return[n*s,i-r*i]}}}function parseAttrBoolean(t,e,s){return null===t?e:/^\s*$/.test(t)?s:!!/true|yes|1/i.test(t)||!/false|no|0/i.test(t)&&e}function parseAttrDimensionArray(t,e,s){if(null===t)return e;if(/^\s*$/.test(t))return s;{const s=t.split(",").map(Number);return 2===s.length&&s[0]&&s[1]?s:e}}function copyOptionsFromElement(t,e,s="acp-"){if(e.hasAttribute(s+"show-hsl")&&(t.showHSL=parseAttrBoolean(e.getAttribute(s+"show-hsl"),DEFAULT.showHSL,!0)),e.hasAttribute(s+"show-rgb")&&(t.showRGB=parseAttrBoolean(e.getAttribute(s+"show-rgb"),DEFAULT.showRGB,!0)),e.hasAttribute(s+"show-hex")&&(t.showHEX=parseAttrBoolean(e.getAttribute(s+"show-hex"),DEFAULT.showHEX,!0)),e.hasAttribute(s+"show-alpha")&&(t.showAlpha=parseAttrBoolean(e.getAttribute(s+"show-alpha"),DEFAULT.showAlpha,!0)),e.hasAttribute(s+"palette-editable")&&(t.paletteEditable=parseAttrBoolean(e.getAttribute(s+"palette-editable"),DEFAULT.paletteEditable,!0)),e.hasAttribute(s+"sl-bar-size")&&(t.slBarSize=parseAttrDimensionArray(e.getAttribute(s+"sl-bar-size"),DEFAULT.slBarSize,[232,150])),e.hasAttribute(s+"hue-bar-size")&&(t.hueBarSize=parseAttrDimensionArray(e.getAttribute(s+"hue-bar-size"),DEFAULT.hueBarSize,[150,11]),t.alphaBarSize=t.hueBarSize),e.hasAttribute(s+"palette")){const i=e.getAttribute(s+"palette");switch(i){case"PALETTE_MATERIAL_500":t.palette=PALETTE_MATERIAL_500;break;case"PALETTE_MATERIAL_CHROME":case"":t.palette=PALETTE_MATERIAL_CHROME;break;default:t.palette=i.split(/[;|]/)}}e.hasAttribute(s+"color")&&(t.color=e.getAttribute(s+"color"))}class ColorPicker{static setHTMLTemplate(t){HTML_BOX=t}#t={id:null,attachTo:"body",showHSL:!0,showRGB:!0,showHEX:!0,showAlpha:!1,color:"#ff0000",palette:null,paletteEditable:!1,useAlphaInPalette:"auto",slBarSize:[232,150],hueBarSize:[130,11],alphaBarSize:[130,11]};constructor(t,e){if(console.warn(t,e),t instanceof HTMLElement==!0)this.container=parseElement(t),this.options=Object.assign({},this.#t,e);else e=t&&isPlainObject(t)?t:e||{},t&&isPlainObject(t)&&(t=null),this.options=Object.assign({},this.#t,e),this.container=parseElement(nvl(t,this.options.attachTo));if(!this.container)throw new Error(`Container not found: ${this.options.attachTo}`);copyOptionsFromElement(this.options,this.container),this.#e()}#e(){if(this.H=0,this.S=0,this.L=0,this.R=0,this.G=0,this.B=0,this.A=1,this.palette={},this.element=document.createElement("div"),this.options.id&&(this.element.id=this.options.id),this.element.className="gs-colorpicker",this.options.show||this.element.classList.add("hidden"),this.element.innerHTML=HTML_BOX,this.container.appendChild(this.element),"EyeDropper"in window){let t=this.element.querySelector(".gs-colorpicker-eyedropper");const e=new EyeDropper;t.addEventListener("click",t=>{e.open().then(t=>{this.onValueChanged(RGBHEX,t.sRGBHex)}).catch(()=>{})})}else this.element.dataset.noEyeDropper;const t=this.element.querySelector(".gs-colorpicker-h");this.setupHueCanvas(t),this.hueBarHelper=canvasHelper(t),this.huePointer=this.element.querySelector(".gs-colorpicker-h+.gs-colorpicker-dot");const e=this.element.querySelector(".gs-colorpicker-sl");this.setupSlCanvas(e),this.slBarHelper=canvasHelper(e),this.slPointer=this.element.querySelector(".gs-colorpicker-sl+.gs-colorpicker-dot"),this.preview=this.element.querySelector(".gs-colorpicker-preview"),this.setupClipboard(this.preview.querySelector(".gs-colorpicker-clipbaord")),this.setupInput(this.inputH=this.element.querySelector(".gs-colorpicker-hsl>input[nameref=H]")),this.setupInput(this.inputS=this.element.querySelector(".gs-colorpicker-hsl>input[nameref=S]")),this.setupInput(this.inputL=this.element.querySelector(".gs-colorpicker-hsl>input[nameref=L]")),this.setupInput(this.inputR=this.element.querySelector(".gs-colorpicker-rgb>input[nameref=R]")),this.setupInput(this.inputG=this.element.querySelector(".gs-colorpicker-rgb>input[nameref=G]")),this.setupInput(this.inputB=this.element.querySelector(".gs-colorpicker-rgb>input[nameref=B]")),this.setupInput(this.inputRGBHEX=this.element.querySelector("input[nameref=RGBHEX]")),this.element.querySelector(".gs-colorpicker-rgbhex").hidden=!this.options.showHEX,this.setPalette(this.paletteRow=this.element.querySelector(".gs-colorpicker-palette")),this.paletteRow=this.element.querySelector(".gs-colorpicker-palette"),this.setupAlphaCanvas(this.element.querySelector(".gs-colorpicker-a")),this.alphaPointer=this.element.querySelector(".gs-colorpicker-a+.gs-colorpicker-dot"),this.element.style.width=`${this.options.slBarSize[0]}px`,this.onValueChanged(COLOR,this.options.color),this.options.afterTemplateConfiguration&&"function"==typeof this.options.afterTemplateConfiguration&&this.options.afterTemplateConfiguration.call(this),this.#s(),this.options.open&&this.element.setAttribute("open")}#s(){this.element.querySelector(".gs-colorpicker-hsl").hidden=!this.options.showHSL,this.element.querySelector(".gs-colorpicker-rgb").hidden=!this.options.showRGB,this.element.querySelector(".gs-colorpicker-alpha").hidden=!this.options.showAlpha,this.paletteRow.hidden=!(this.options.paletteEditable||this.options.palette&&this.options.palette.length>0)}setOptions(t){console.warn("SET PICKER OPTIONS",t),this.options=Object.assign({},this.options,t),this.updatePalette(),this.#s()}setupHueCanvas(t){t.width=this.options.hueBarSize[0],t.height=this.options.hueBarSize[1];const e=t.getContext("2d"),s=e.createLinearGradient(0,0,this.options.hueBarSize[0],0),i=1/360;for(let t=0;t<=1;t+=i)s.addColorStop(t,`hsl(${360*t}, 100%, 50%)`);e.fillStyle=s,e.fillRect(0,0,this.options.hueBarSize[0],this.options.hueBarSize[1]);const o=e=>{const s=limit(e.clientX-t.getBoundingClientRect().left,0,this.options.hueBarSize[0]),i=Math.round(360*s/this.options.hueBarSize[0]);this.huePointer.style.left=s-7+"px",this.onValueChanged("H",i)},n=()=>{document.removeEventListener("mousemove",o),document.removeEventListener("mouseup",n)};t.addEventListener("mousedown",t=>{o(t),document.addEventListener("mousemove",o),document.addEventListener("mouseup",n)})}setupSlCanvas(t){t.width=this.options.slBarSize[0],t.height=this.options.slBarSize[1];const e=e=>{const s=limit(e.clientX-t.getBoundingClientRect().left,0,this.options.slBarSize[0]-1),i=limit(e.clientY-t.getBoundingClientRect().top,0,this.options.slBarSize[1]-1),o=this.slBarHelper.grabColor(s,i);this.slPointer.style.left=s-7+"px",this.slPointer.style.top=i-7+"px",this.onValueChanged(RGB,o)},s=()=>{document.removeEventListener("mousemove",e),document.removeEventListener("mouseup",s)};t.addEventListener("mousedown",t=>{e(t),document.addEventListener("mousemove",e),document.addEventListener("mouseup",s)})}setupAlphaCanvas(t){t.width=this.options.alphaBarSize[0],t.height=this.options.alphaBarSize[1];const e=t.getContext("2d"),s=e.createLinearGradient(0,0,t.width-1,0);s.addColorStop(0,"hsla(0, 0%, 50%, 0)"),s.addColorStop(1,"hsla(0, 0%, 50%, 1)"),e.fillStyle=s,e.fillRect(0,0,this.options.alphaBarSize[0],this.options.alphaBarSize[1]);const i=e=>{const s=limit(e.clientX-t.getBoundingClientRect().left,0,this.options.alphaBarSize[0]),i=+(s/this.options.alphaBarSize[0]).toFixed(2);this.alphaPointer.style.left=s-7+"px",this.onValueChanged(ALPHA,i)},o=()=>{document.removeEventListener("mousemove",i),document.removeEventListener("mouseup",o)};t.addEventListener("mousedown",t=>{i(t),document.addEventListener("mousemove",i),document.addEventListener("mouseup",o)})}setupInput(t){const e=+t.min,s=+t.max,i=t.getAttribute("nameref");t.hasAttribute("select-on-focus")&&t.addEventListener("focus",()=>{t.select()}),"text"===t.type?t.addEventListener("change",()=>{this.onValueChanged(i,t.value)}):((IS_EDGE||IS_IE11)&&t.addEventListener("keydown",o=>{"Up"===o.key?(t.value=limit(+t.value+1,e,s),this.onValueChanged(i,t.value),o.returnValue=!1):"Down"===o.key&&(t.value=limit(+t.value-1,e,s),this.onValueChanged(i,t.value),o.returnValue=!1)}),t.addEventListener("change",()=>{const o=+t.value;this.onValueChanged(i,limit(o,e,s))}))}setupClipboard(t){t.title="click to copy",t.addEventListener("click",()=>{t.value=parseColor([this.R,this.G,this.B,this.A],"hexcss4"),t.select(),document.execCommand("copy")})}setPalette(t){const e="auto"===this.options.useAlphaInPalette?this.options.showAlpha:this.options.useAlphaInPalette;let s=null;switch(this.options.palette){case"PALETTE_MATERIAL_500":s=PALETTE_MATERIAL_500;break;case"PALETTE_MATERIAL_CHROME":s=PALETTE_MATERIAL_CHROME;break;default:s=ensureArray(this.options.palette)}if(this.options.paletteEditable||s.length>0){const i=(e,s,i)=>{const o=t.querySelector('.gs-colorpicker-palette-color[data-color="'+e+'"]')||document.createElement("div");o.className="gs-colorpicker-palette-color",o.style.backgroundColor=e,o.setAttribute("data-color",e),o.title=e,t.insertBefore(o,s),this.palette[e]=!0,i&&this.onPaletteColorAdd(e)},o=(e,s)=>{e?(t.removeChild(e),this.palette[e.getAttribute("data-color")]=!1,s&&this.onPaletteColorRemove(e.getAttribute("data-color"))):(t.querySelectorAll(".gs-colorpicker-palette-color[data-color]").forEach(e=>{t.removeChild(e)}),Object.keys(this.palette).forEach(t=>{this.palette[t]=!1}),s&&this.onPaletteColorRemove())};if(s.map(t=>parseColor(t,e?"rgbcss4":"hex")).filter(t=>!!t).forEach(t=>i(t)),this.paletteColors&&this.paletteColors.map(t=>parseColor(t,this.options.showAlpha&&e?"rgbcss4":"hex")).filter(t=>!!t).forEach(t=>{console.info("COLOR",t),i(t,null,!1)}),this.options.paletteEditable){const s=document.createElement("div");s.className="gs-colorpicker-palette-color gs-colorpicker-palette-add",s.innerHTML="+",t.appendChild(s),t.addEventListener("click",t=>{/gs-colorpicker-palette-add/.test(t.target.className)?t.shiftKey?o(null,!0):i(e?parseColor([this.R,this.G,this.B,this.A],"rgbcss4"):rgbToHex(this.R,this.G,this.B),t.target,!0):/gs-colorpicker-palette-color/.test(t.target.className)&&(t.shiftKey?o(t.target,!0):this.onValueChanged(COLOR,t.target.getAttribute("data-color")))})}else t.addEventListener("click",t=>{/gs-colorpicker-palette-color/.test(t.target.className)&&this.onValueChanged(COLOR,t.target.getAttribute("data-color"))})}else t.style.display="none"}updatePalette(t){this.paletteRow.innerHTML="",this.palette={},this.paletteRow.parentElement||this.element.appendChild(this.paletteRow),this.options.palette=t,this.setPalette(this.paletteRow)}onValueChanged(t,e,s={silent:!1}){switch(t){case"H":this.H=e,[this.R,this.G,this.B]=hslToRgb(this.H,this.S,this.L),this.slBarHelper.setHue(e),this.updatePointerH(this.H),this.updateInputHSL(this.H,this.S,this.L),this.updateInputRGB(this.R,this.G,this.B),this.updateInputRGBHEX(this.R,this.G,this.B,this.A);break;case"S":this.S=e,[this.R,this.G,this.B]=hslToRgb(this.H,this.S,this.L),this.updatePointerSL(this.H,this.S,this.L),this.updateInputHSL(this.H,this.S,this.L),this.updateInputRGB(this.R,this.G,this.B),this.updateInputRGBHEX(this.R,this.G,this.B,this.A);break;case"L":this.L=e,[this.R,this.G,this.B]=hslToRgb(this.H,this.S,this.L),this.updatePointerSL(this.H,this.S,this.L),this.updateInputHSL(this.H,this.S,this.L),this.updateInputRGB(this.R,this.G,this.B),this.updateInputRGBHEX(this.R,this.G,this.B,this.A);break;case"R":this.R=e,[this.H,this.S,this.L]=rgbToHsl(this.R,this.G,this.B),this.slBarHelper.setHue(this.H),this.updatePointerH(this.H),this.updatePointerSL(this.H,this.S,this.L),this.updateInputHSL(this.H,this.S,this.L),this.updateInputRGBHEX(this.R,this.G,this.B,this.A);break;case"G":this.G=e,[this.H,this.S,this.L]=rgbToHsl(this.R,this.G,this.B),this.slBarHelper.setHue(this.H),this.updatePointerH(this.H),this.updatePointerSL(this.H,this.S,this.L),this.updateInputHSL(this.H,this.S,this.L),this.updateInputRGBHEX(this.R,this.G,this.B,this.A);break;case"B":this.B=e,[this.H,this.S,this.L]=rgbToHsl(this.R,this.G,this.B),this.slBarHelper.setHue(this.H),this.updatePointerH(this.H),this.updatePointerSL(this.H,this.S,this.L),this.updateInputHSL(this.H,this.S,this.L),this.updateInputRGBHEX(this.R,this.G,this.B,this.A);break;case RGB:[this.R,this.G,this.B]=e,[this.H,this.S,this.L]=rgbToHsl(this.R,this.G,this.B),this.updateInputHSL(this.H,this.S,this.L),this.updateInputRGB(this.R,this.G,this.B),this.updateInputRGBHEX(this.R,this.G,this.B,this.A);break;case RGBA_USER:[this.R,this.G,this.B,this.A]=e,[this.H,this.S,this.L]=rgbToHsl(this.R,this.G,this.B),this.slBarHelper.setHue(this.H),this.updatePointerH(this.H),this.updatePointerSL(this.H,this.S,this.L),this.updateInputHSL(this.H,this.S,this.L),this.updateInputRGB(this.R,this.G,this.B),this.updateInputRGBHEX(this.R,this.G,this.B,this.A),this.updatePointerA(this.A);break;case HSLA_USER:[this.H,this.S,this.L,this.A]=e,[this.R,this.G,this.B]=hslToRgb(this.H,this.S,this.L),this.slBarHelper.setHue(this.H),this.updatePointerH(this.H),this.updatePointerSL(this.H,this.S,this.L),this.updateInputHSL(this.H,this.S,this.L),this.updateInputRGB(this.R,this.G,this.B),this.updateInputRGBHEX(this.R,this.G,this.B,this.A),this.updatePointerA(this.A);break;case RGBHEX:[this.R,this.G,this.B,this.A]=cssColorToRgba(e)||[this.R,this.G,this.B,this.A],[this.H,this.S,this.L]=rgbToHsl(this.R,this.G,this.B),this.slBarHelper.setHue(this.H),this.updatePointerH(this.H),this.updatePointerSL(this.H,this.S,this.L),this.updateInputHSL(this.H,this.S,this.L),this.updateInputRGB(this.R,this.G,this.B),this.updatePointerA(this.A);break;case COLOR:[this.R,this.G,this.B,this.A]=parseColor(e,"rgba")||[0,0,0,1],[this.H,this.S,this.L]=rgbToHsl(this.R,this.G,this.B),this.slBarHelper.setHue(this.H),this.updatePointerH(this.H),this.updatePointerSL(this.H,this.S,this.L),this.updateInputHSL(this.H,this.S,this.L),this.updateInputRGB(this.R,this.G,this.B),this.updateInputRGBHEX(this.R,this.G,this.B,this.A),this.updatePointerA(this.A);break;case ALPHA:this.A=e,this.updateInputRGBHEX(this.R,this.G,this.B,this.A)}1===this.A?this.preview.style.backgroundColor=`rgb(${this.R},${this.G},${this.B})`:this.preview.style.backgroundColor=`rgba(${this.R},${this.G},${this.B},${this.A})`,s&&s.silent||this.onchange&&this.onchange(this.preview.style.backgroundColor)}onPaletteColorAdd(t){this.paletteColors||(this.paletteColors=[]),this.paletteColors.push(t),this.oncoloradd&&this.oncoloradd(t)}onPaletteColorRemove(t){this.oncolorremove&&this.oncolorremove(t)}updateInputHSL(t,e,s){this.options.showHSL&&(this.inputH.value=t,this.inputS.value=e,this.inputL.value=s)}updateInputRGB(t,e,s){this.options.showRGB&&(this.inputR.value=t,this.inputG.value=e,this.inputB.value=s)}updateInputRGBHEX(t,e,s,i){this.options.showHEX&&(this.options.showAlpha?this.inputRGBHEX.value=parseColor([t,e,s,i],"hexcss4"):this.inputRGBHEX.value=rgbToHex(t,e,s))}updatePointerH(t){const e=this.options.hueBarSize[0]*t/360;this.huePointer.style.left=e-7+"px"}updatePointerSL(t,e,s){const[i,o,n]=hslToRgb(t,e,s),[r,l]=this.slBarHelper.findColor(i,o,n);r>=0&&(this.slPointer.style.left=r-7+"px",this.slPointer.style.top=l-7+"px")}updatePointerA(t){if(!this.options.showAlpha)return;const e=this.options.alphaBarSize[0]*t;this.alphaPointer.style.left=e-7+"px"}}class EventEmitter{constructor(t){this.name=t,this.listeners=[]}on(t){t&&this.listeners.push(t)}off(t){this.listeners=t?this.listeners.filter(e=>e!==t):[]}emit(t,e){const s=this.listeners.slice(0);for(let i=0;i<s.length;i++)s[i].apply(e,t)}}function keepInViewport(t,e,s){const i=t.getBoundingClientRect(),o=window.innerWidth,n=window.innerHeight,r=o-i.width,l=n-i.height,h=Math.max(0,Math.min(e,r)),a=Math.max(0,Math.min(s,l));t.style.transform=`translate(${h}px, ${a}px)`}function createPicker(t,e){let s,i=new ColorPicker(t,e),o={change:new EventEmitter("change"),coloradd:new EventEmitter("coloradd"),colorremove:new EventEmitter("colorremove")},n=!0,r={},l=function(t){t?(window.removeEventListener("click",h,!0),window.removeEventListener("mousedown",h,!0),window.removeEventListener("keydown",a,!0)):(window.addEventListener("click",h,!0),window.addEventListener("mousedown",h,!0),window.addEventListener("keydown",a,!0))},h=function(t){i.element.contains(t.target)||p.hide()},a=function(t){"ESCAPE"!==t.key.toUpperCase()||i.element.contains(t.target)||p.hide()};const p={get element(){return i.element},get rgb(){return[i.R,i.G,i.B]},set rgb([t,e,s]){[t,e,s]=[limit(t,0,255),limit(e,0,255),limit(s,0,255)],i.onValueChanged(RGBA_USER,[t,e,s,1])},get hsl(){return[i.H,i.S,i.L]},set hsl([t,e,s]){[t,e,s]=[limit(t,0,360),limit(e,0,100),limit(s,0,100)],i.onValueChanged(HSLA_USER,[t,e,s,1])},get rgbhex(){return this.all.hex},get rgba(){return[i.R,i.G,i.B,i.A]},set rgba([t,e,s,o]){[t,e,s,o]=[limit(t,0,255),limit(e,0,255),limit(s,0,255),limit(o,0,1)],i.onValueChanged(RGBA_USER,[t,e,s,o])},get hsla(){return[i.H,i.S,i.L,i.A]},set hsla([t,e,s,o]){[t,e,s,o]=[limit(t,0,360),limit(e,0,100),limit(s,0,100),limit(o,0,1)],i.onValueChanged(HSLA_USER,[t,e,s,o])},get color(){return this.all.toString()},set color(t){i.onValueChanged(COLOR,t)},setColor(t,e=!1){i.onValueChanged(COLOR,t,{silent:e})},get all(){if(n){const t=[i.R,i.G,i.B,i.A],e=i.A<1?`rgba(${i.R},${i.G},${i.B},${i.A})`:rgbToHex(...t);r=parseColor(t,r),r.toString=()=>e,n=!1}return Object.assign({},r)},get onchange(){return o.change&&o.change.listeners[0]},set onchange(t){this.off("change").on("change",t)},get oncoloradd(){return o.coloradd&&o.coloradd.listeners[0]},set oncoloradd(t){this.off("coloradd").on("coloradd",t)},get oncolorremove(){return o.colorremove&&o.colorremove.listeners[0]},set oncolorremove(t){this.off("colorremove").on("colorremove",t)},get palette(){return Object.keys(i.palette).filter(t=>i.palette[t])},set palette(t){i.updatePalette(t)},show(){i.element.classList.remove("hidden")},openPicker({target:t,x:e,y:o,color:n},r){if(t&&(!e||!o)){let s=t.getBoundingClientRect();e=s.x,o=s.y+s.height}isNaN(e)&&(e=.5*window.innerWidth),isNaN(o)&&(o=0),keepInViewport(i.element,e,o),i.element.classList.remove("hidden"),n=parseColor(n||"#000","rgba"),i.onValueChanged(COLOR,n,{silent:!0}),l(),r&&(s=r,this.on("change",s))},setOptions(t){i.setOptions(t)},hide(){i.element.classList.add("hidden"),l(!0),s&&this.off("change",s),s=null},toggle(){i.element.classList.toggle("hidden"),l(i.classList.contains("hidden")),i.element.classList.contains("hidden")&&s&&(this.off("change",s),s=null)},on(t,e){return t&&o[t]&&o[t].on(e),this},off(t,e){return t&&o[t]&&o[t].off(e),this},destroy(){window.removeEventListener("click",this.onmouseDown,!0),o.change.off(),o.coloradd.off(),o.colorremove.off(),i.element.remove(),o=null,i=null}};return i.onchange=(...t)=>{n=!0,o.change.emit([p,...t],p)},i.oncoloradd=(...t)=>{o.coloradd.emit([p,...t],p)},i.oncolorremove=(...t)=>{o.colorremove.emit([p,...t],p)},i.element.ctrl=p,p}function from(t,e){const s=parseElements(t).map((t,s)=>{const i=createPicker(t,e);return i.index=s,i});return s.on=function(t,e){return s.forEach(s=>s.on(t,e)),this},s.off=function(t){return s.forEach(e=>e.off(t)),this},s}export default{createPicker:createPicker,from:from,parseColorToRgb:parseColorToRgb,parseColorToRgba:parseColorToRgba,parseColorToHsl:parseColorToHsl,parseColorToHsla:parseColorToHsla,parseColor:parseColor,rgbToHex:rgbToHex,hslToRgb:hslToRgb,rgbToHsl:rgbToHsl,rgbToHsv:rgbToHsv,rgbToInt:rgbToInt,intToRgb:intToRgb,getLuminance:getLuminance,COLOR_NAMES:COLOR_NAMES,PALETTE_MATERIAL_500:PALETTE_MATERIAL_500,PALETTE_MATERIAL_CHROME:PALETTE_MATERIAL_CHROME,VERSION:"1.2.2"};